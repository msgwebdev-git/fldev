# üì∏ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–æ—Ç–æ –≤ –≥–∞–ª–µ—Ä–µ—é

–≠—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–∂–∞—Ç–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –≤ Supabase Storage.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

–ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤—Å–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –ø–∞–ø–∫—É, –Ω–∞–ø—Ä–∏–º–µ—Ä:
```
/Users/username/photos/2022/
  ‚îú‚îÄ‚îÄ IMG_001.jpg
  ‚îú‚îÄ‚îÄ IMG_002.jpg
  ‚îî‚îÄ‚îÄ ...
```

### –®–∞–≥ 2: –°–∂–∞—Ç–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —Å–∂–∞—Ç–∏—è:

```bash
npm run compress-images /Users/username/photos/2022 ./compressed 2022
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `inputDir` - –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º–∏ —Ñ–æ—Ç–æ
- `outputDir` - –ø—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–∂–∞—Ç—ã—Ö —Ñ–æ—Ç–æ
- `year` - –≥–æ–¥ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, 2022)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
./compressed/
  ‚îî‚îÄ‚îÄ 2022/
      ‚îú‚îÄ‚îÄ thumbnails/    # –ú–∏–Ω–∏–∞—Ç—é—Ä—ã 400x300 WebP
      ‚îÇ   ‚îú‚îÄ‚îÄ IMG_001.webp
      ‚îÇ   ‚îú‚îÄ‚îÄ IMG_002.webp
      ‚îÇ   ‚îî‚îÄ‚îÄ ...
      ‚îî‚îÄ‚îÄ full/          # –ü–æ–ª–Ω—ã–µ 1920x1440 WebP
          ‚îú‚îÄ‚îÄ IMG_001.webp
          ‚îú‚îÄ‚îÄ IMG_002.webp
          ‚îî‚îÄ‚îÄ ...
```

### –®–∞–≥ 3: –ó–∞–≥—Ä—É–∑–∫–∞ –≤ Supabase

**–í–∞–∂–Ω–æ!** –ü–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `.env.local` –µ—Å—Ç—å:
```env
NEXT_PUBLIC_SUPABASE_URL=your-project-url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏:
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
```

–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ –≤ Supabase:

```bash
npm run upload-gallery ./compressed 2022
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `inputDir` - –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å–æ —Å–∂–∞—Ç—ã–º–∏ —Ñ–æ—Ç–æ
- `year` - –≥–æ–¥ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- `bucketName` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –Ω–∞–∑–≤–∞–Ω–∏–µ bucket (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "gallery")

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase Storage

1. –ó–∞–π–¥–∏—Ç–µ –≤ Supabase Dashboard
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Storage ‚Üí Policies
3. –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª–∏—Ç–∏–∫—É –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ bucket "gallery":

```sql
-- –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—Å–µ–º —á–∏—Ç–∞—Ç—å –∏–∑ gallery bucket
CREATE POLICY "Public Access"
ON storage.objects FOR SELECT
USING (bucket_id = 'gallery');
```

## üìä –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∂–∞—Ç–∏—è

–î–ª—è 207 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π (130 MB):
- **Thumbnails:** ~10-15 MB
- **Full:** ~60-80 MB
- **–≠–∫–æ–Ω–æ–º–∏—è:** ~40-50%

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–∂–∞—Ç–∏—è

–í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∂–∞—Ç–∏—è –≤ `compress-images.ts`:

```typescript
compressImages({
  inputDir: './photos/2022',
  outputDir: './compressed',
  year: '2022',
  thumbnailWidth: 400,      // –®–∏—Ä–∏–Ω–∞ –º–∏–Ω–∏–∞—Ç—é—Ä—ã
  thumbnailHeight: 300,     // –í—ã—Å–æ—Ç–∞ –º–∏–Ω–∏–∞—Ç—é—Ä—ã
  fullWidth: 1920,          // –ú–∞–∫—Å —à–∏—Ä–∏–Ω–∞ full
  fullHeight: 1440,         // –ú–∞–∫—Å –≤—ã—Å–æ—Ç–∞ full
  quality: 85,              // –ö–∞—á–µ—Å—Ç–≤–æ WebP (0-100)
});
```

## üåê URL —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ URL:

```
https://your-project.supabase.co/storage/v1/object/public/gallery/2022/thumbnails/IMG_001.webp
https://your-project.supabase.co/storage/v1/object/public/gallery/2022/full/IMG_001.webp
```

## ‚ùì –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –û—à–∏–±–∫–∞ "bucket not found"
–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç bucket –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ. –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è, —Å–æ–∑–¥–∞–π—Ç–µ bucket –≤—Ä—É—á–Ω—É—é –≤ Supabase Dashboard.

### –û—à–∏–±–∫–∞ "SUPABASE_URL not found"
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `.env.local` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
–ï—Å–ª–∏ —É –≤–∞—Å –±–æ–ª—å—à–µ 100 —Ñ–æ—Ç–æ, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `SUPABASE_SERVICE_ROLE_KEY` –¥–ª—è –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ (–±–µ–∑ rate limiting).

## üìù –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

```bash
# 1. –°–∂–∞—Ç—å —Ñ–æ—Ç–æ 2022 –≥–æ–¥–∞
npm run compress-images ~/Downloads/festival-2022 ./compressed 2022

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
ls -lh ./compressed/2022/thumbnails
ls -lh ./compressed/2022/full

# 3. –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤ Supabase
npm run upload-gallery ./compressed 2022

# 4. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≥–∞–ª–µ—Ä–µ–∏ (—Å–º. —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥)
```

## üéØ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥

–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ –æ–±–Ω–æ–≤–∏—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≥–∞–ª–µ—Ä–µ–∏ (`src/app/[locale]/gallery/page.tsx`), —á—Ç–æ–±—ã –æ–Ω –∑–∞–≥—Ä—É–∂–∞–ª —Ñ–æ—Ç–æ –∏–∑ Supabase –≤–º–µ—Å—Ç–æ mock –¥–∞–Ω–Ω—ã—Ö.
